<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proposal Creator - Bridely.ai</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: sans-serif;
            background-color: #FFFBEB; /* Amber Background */
        }
        /* Custom Colors */
        .bg-olive { background-color: #365314; }
        .text-olive { color: #365314; }
        .text-gold { color: #B45309; }
        .border-gold { border-color: #B45309; }
        .focus\:ring-gold:focus { --tw-ring-color: #B45309; }
        .text-brown { color: #78350F; }
        .bg-golden-brown { background-color: #92400E; }
        .hover\:bg-golden-brown-dark:hover { background-color: #78350F; }
        
        /* Toggle Switch styling */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #B45309;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #B45309;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Navigation -->
    <nav class="bg-olive shadow-md fixed top-0 w-full z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                 <div class="flex-shrink-0">
                    <a href="/bradely/landing-page.html" class="text-2xl font-bold text-white">bridely.ai <span class="text-sm font-medium text-amber-300">for Vendors</span></a>
                </div>
                <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
                    <a href="#" class="text-gray-300 hover:text-white">Dashboard</a>
                    <a href="#" class="text-amber-300 border-b-2 border-amber-300">Bookings</a>
                    <!-- Other nav items -->
                </div>
                <div class="hidden sm:ml-6 sm:flex sm:items-center">
                    <span class="text-sm text-gray-300">Aloha Photography</span>
                    <a href="/bradely/landing-page.html" class="ml-4 text-sm font-medium text-gray-400 hover:text-white">Log out</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-24 pb-12">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">

            <!-- Header -->
            <header class="mb-8">
                <div>
                    <h1 class="text-3xl font-bold text-olive">Create Proposal for Jane & John</h1>
                    <p class="text-lg text-brown">Wedding Date: October 26, 2026</p>
                </div>
            </header>
            
            <div class="bg-white p-8 rounded-lg shadow-xl space-y-12">
            
                <!-- Services / Line Items -->
                <section>
                    <h2 class="text-xl font-semibold text-gray-800">Services & Pricing</h2>
                    <div class="mt-4 flow-root">
                        <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
                            <div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
                                <table class="min-w-full divide-y divide-gray-300">
                                    <thead>
                                        <tr>
                                            <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-0">Service</th>
                                            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Quantity</th>
                                            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Price</th>
                                            <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Total</th>
                                            <th scope="col" class="relative py-3.5 pl-3 pr-4 sm:pr-0"><span class="sr-only">Remove</span></th>
                                        </tr>
                                    </thead>
                                    <tbody id="line-items-body" class="divide-y divide-gray-200">
                                        <!-- Row 1 -->
                                        <tr>
                                            <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-0">
                                                <input type="text" value="Full Day Wedding Photography" class="w-full border-gray-300 rounded-md shadow-sm line-item-desc">
                                            </td>
                                            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
                                                <input type="number" value="8" class="w-20 border-gray-300 rounded-md shadow-sm line-item-qty">
                                            </td>
                                            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
                                                <input type="number" value="500" class="w-24 border-gray-300 rounded-md shadow-sm line-item-price">
                                            </td>
                                            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-700 font-medium line-item-total">$4,000.00</td>
                                            <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-0">
                                                <button class="text-red-600 hover:text-red-900 remove-line-item">Remove</button>
                                            </td>
                                        </tr>
                                         <!-- Row 2 -->
                                        <tr>
                                            <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-0">
                                                <input type="text" value="Engagement Session" class="w-full border-gray-300 rounded-md shadow-sm line-item-desc">
                                            </td>
                                            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
                                                <input type="number" value="1" class="w-20 border-gray-300 rounded-md shadow-sm line-item-qty">
                                            </td>
                                            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500">
                                                <input type="number" value="500" class="w-24 border-gray-300 rounded-md shadow-sm line-item-price">
                                            </td>
                                            <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-700 font-medium line-item-total">$500.00</td>
                                            <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-0">
                                                <button class="text-red-600 hover:text-red-900 remove-line-item">Remove</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                     <button id="addLineItem" class="mt-4 text-sm font-medium text-gold hover:text-brown">+ Add Line Item</button>
                    <!-- Totals -->
                    <div class="mt-6 flex justify-end">
                        <div class="w-full max-w-sm space-y-3">
                            <div class="flex justify-between">
                                <span class="text-sm text-gray-500">Subtotal</span>
                                <span id="subtotal" class="text-sm font-medium text-gray-800">$4,500.00</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">Discount</span>
                                <div class="flex items-center space-x-1">
                                    <input type="number" id="discount-value" value="10" class="w-20 border-gray-300 rounded-md shadow-sm sm:text-sm">
                                    <select id="discount-type" class="border-gray-300 rounded-md shadow-sm sm:text-sm">
                                        <option value="percent">%</option>
                                        <option value="fixed">$</option>
                                    </select>
                                </div>
                            </div>
                             <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">Tax</span>
                                <div class="flex items-center space-x-1">
                                    <input type="number" id="tax-value" value="4.712" step="0.001" class="w-20 border-gray-300 rounded-md shadow-sm sm:text-sm">
                                    <span class="text-gray-500">%</span>
                                </div>
                            </div>
                             <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">Card Processing Fee</span>
                                <div class="flex items-center space-x-2">
                                    <span id="processing-fee" class="text-sm font-medium text-gray-800">$0.00</span>
                                    <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                        <input type="checkbox" name="pass-fee" id="pass-fee-toggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-2 appearance-none cursor-pointer"/>
                                        <label for="pass-fee-toggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                                    </div>
                                    <label for="pass-fee-toggle" class="text-xs text-gray-500">Pass fee to client</label>
                                </div>
                            </div>
                            <div class="flex justify-between pt-2 border-t">
                                <span class="text-base font-semibold text-gray-900">Total</span>
                                <span id="total" class="text-base font-semibold text-gray-900">$4,499.54</span>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Payment Schedule -->
                <section>
                    <div class="flex justify-between items-center">
                        <h2 class="text-xl font-semibold text-gray-800">Payment Schedule</h2>
                        <button id="add-payment" class="text-sm font-medium text-gold hover:text-brown">+ Add Installment</button>
                    </div>
                    <div id="payment-schedule-body" class="mt-4 space-y-4">
                        <!-- Payments will be added by JS -->
                    </div>
                </section>
                
                <!-- Contract Terms -->
                <section>
                    <h2 class="text-xl font-semibold text-gray-800">Contract Terms & Conditions</h2>
                    <div class="mt-4">
                        <textarea rows="10" class="w-full border-gray-300 rounded-md shadow-sm" placeholder="Enter your contract terms here. E.g., Cancellation Policy, Image Rights, etc.">This agreement constitutes the entire agreement between the parties...
                        
CANCELLATION: If the event is canceled, the deposit is non-refundable.

IMAGE USAGE: The photographer retains the right to use the images for promotional purposes.</textarea>
                    </div>
                </section>

                <!-- Actions -->
                <footer class="pt-8 border-t flex items-center justify-end space-x-4">
                    <button class="text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 px-4 py-2 rounded-md border">Save as Draft</button>
                    <button class="text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 px-4 py-2 rounded-md border">Preview</button>
                    <button class="text-sm font-medium text-white bg-golden-brown hover:bg-golden-brown-dark px-4 py-2 rounded-md shadow-sm">Generate Contract & Send</button>
                </footer>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const lineItemsBody = document.getElementById('line-items-body');
            const addLineItemBtn = document.getElementById('addLineItem');
            const subtotalEl = document.getElementById('subtotal');
            const discountValueEl = document.getElementById('discount-value');
            const discountTypeEl = document.getElementById('discount-type');
            const taxValueEl = document.getElementById('tax-value');
            const processingFeeEl = document.getElementById('processing-fee');
            const passFeeToggle = document.getElementById('pass-fee-toggle');
            const totalEl = document.getElementById('total');
            const paymentScheduleBody = document.getElementById('payment-schedule-body');
            const addPaymentBtn = document.getElementById('add-payment');
            
            let paymentSchedules = [
                { type: 'percent', value: 50, due: 'Upon signing' },
                { type: 'remainder', value: 0, due: '2026-10-01' }
            ];

            const formatCurrency = (amount) => {
                return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount);
            };

            const calculateTotals = () => {
                let subtotal = 0;
                lineItemsBody.querySelectorAll('tr').forEach(row => {
                    const qty = parseFloat(row.querySelector('.line-item-qty').value) || 0;
                    const price = parseFloat(row.querySelector('.line-item-price').value) || 0;
                    const totalCell = row.querySelector('.line-item-total');
                    const lineTotal = qty * price;
                    totalCell.textContent = formatCurrency(lineTotal);
                    subtotal += lineTotal;
                });
                subtotalEl.textContent = formatCurrency(subtotal);

                const discountValue = parseFloat(discountValueEl.value) || 0;
                const discountType = discountTypeEl.value;
                let discountAmount = 0;
                if (discountType === 'percent') {
                    discountAmount = subtotal * (discountValue / 100);
                } else {
                    discountAmount = discountValue;
                }
                const subtotalAfterDiscount = subtotal - discountAmount;

                const taxRate = parseFloat(taxValueEl.value) || 0;
                const taxAmount = subtotalAfterDiscount * (taxRate / 100);

                let total = subtotalAfterDiscount + taxAmount;
                
                // Calculate processing fee based on the amount the client would pay
                const processingFeeAmount = (total * 0.029) + 0.30;
                processingFeeEl.textContent = formatCurrency(processingFeeAmount);

                if(passFeeToggle.checked) {
                    total += processingFeeAmount;
                }
                
                totalEl.textContent = formatCurrency(total);
                
                renderPaymentSchedule(total);
            };

            const renderPaymentSchedule = (total) => {
                paymentScheduleBody.innerHTML = '';
                let remainingTotal = total;
                let hasRemainder = paymentSchedules.some(p => p.type === 'remainder');

                paymentSchedules.forEach((payment, index) => {
                    let amount = 0;
                     if(payment.type === 'percent') {
                        amount = total * (payment.value / 100);
                    } else if (payment.type === 'fixed') {
                        amount = payment.value;
                    } else { // remainder
                        amount = remainingTotal > 0 ? remainingTotal : 0;
                    }
                    if(payment.type !== 'remainder') {
                        remainingTotal -= amount;
                    }

                    const paymentDiv = document.createElement('div');
                    paymentDiv.className = 'flex items-center space-x-4 p-2 bg-gray-50 rounded-md';
                    paymentDiv.innerHTML = `
                        <input type="text" value="${payment.due}" class="border-gray-300 rounded-md shadow-sm sm:text-sm flex-grow" placeholder="Due Date or Milestone">
                        <select class="payment-type border-gray-300 rounded-md shadow-sm sm:text-sm" data-index="${index}">
                            <option value="percent" ${payment.type === 'percent' ? 'selected' : ''}>%</option>
                            <option value="fixed" ${payment.type === 'fixed' ? 'selected' : ''}>$</option>
                            <option value="remainder" ${payment.type === 'remainder' ? 'selected' : ''}>Remainder</option>
                        </select>
                        <input type="number" value="${payment.value}" class="w-24 border-gray-300 rounded-md shadow-sm sm:text-sm payment-value" ${payment.type === 'remainder' ? 'disabled' : ''}>
                        <span class="font-bold text-gray-800 w-28 text-right">${formatCurrency(amount)}</span>
                        <button class="text-red-500 hover:text-red-700 remove-payment" data-index="${index}">&#x2715;</button>
                    `;
                    paymentScheduleBody.appendChild(paymentDiv);
                });
            };

            addLineItemBtn.addEventListener('click', () => {
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <td class="whitespace-nowrap py-4 pl-4 pr-3 text-sm sm:pl-0"><input type="text" placeholder="Service Description" class="w-full border-gray-300 rounded-md shadow-sm line-item-desc"></td>
                    <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500"><input type="number" value="1" class="w-20 border-gray-300 rounded-md shadow-sm line-item-qty"></td>
                    <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-500"><input type="number" placeholder="0.00" class="w-24 border-gray-300 rounded-md shadow-sm line-item-price"></td>
                    <td class="whitespace-nowrap px-3 py-4 text-sm text-gray-700 font-medium line-item-total">$0.00</td>
                    <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-0"><button class="text-red-600 hover:text-red-900 remove-line-item">Remove</button></td>
                `;
                lineItemsBody.appendChild(newRow);
            });

            lineItemsBody.addEventListener('input', calculateTotals);
            lineItemsBody.addEventListener('click', e => {
                if (e.target.classList.contains('remove-line-item')) {
                    e.target.closest('tr').remove();
                    calculateTotals();
                }
            });
            
            addPaymentBtn.addEventListener('click', () => {
                paymentSchedules.push({ type: 'fixed', value: 0, due: '' });
                calculateTotals();
            });
            
            paymentScheduleBody.addEventListener('change', (e) => {
                const index = e.target.closest('div').querySelector('.payment-type')?.dataset.index || e.target.closest('div').querySelector('.payment-value')?.previousElementSibling.dataset.index;
                if(e.target.classList.contains('payment-type')) {
                    paymentSchedules[index].type = e.target.value;
                    e.target.nextElementSibling.disabled = e.target.value === 'remainder';
                }
                if(e.target.classList.contains('payment-value')) {
                     paymentSchedules[index].value = parseFloat(e.target.value) || 0;
                }
                 calculateTotals();
            });

            paymentScheduleBody.addEventListener('click', e => {
                 if (e.target.classList.contains('remove-payment')) {
                    paymentSchedules.splice(e.target.dataset.index, 1);
                    calculateTotals();
                }
            });


            [discountValueEl, discountTypeEl, taxValueEl, passFeeToggle].forEach(el => el.addEventListener('input', calculateTotals));

            calculateTotals();
        });
    </script>
</body>
</html>
